language: android
jdk: oraclejdk8
sudo: false

cache:
  directories:
  - "$HOME/.m2"

before_cache:
- rm -rf $HOME/.m2/repository/io/cucumber

android:
  components:
  - tools
  - platform-tools
  - tools


before_install:
  - echo no | android create avd --force -n test -t android-26 --abi armeabi-v7a
  - emulator -avd test -no-audio -no-window &
  - wait_for_emulator
  - adb shell input keyevent 82 &

install:
  - ./gradlew build runInstrumentationTests

deploy:
  provider: script
  script: ./gradlew publish
  on:
    branch: master